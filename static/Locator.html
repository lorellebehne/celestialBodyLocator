<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
	<link rel=stylesheet href="mapStyle.css">
    <title>Star mapper</title>
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  <body>
	<div class = narrowCol>
		<h1>What is directly above? When?</h1>
		<input type="date" id="date"></input>
		<select id="body">
			<option value="moon">Moon</option>
			<option value="sun">Sun</option>
			<option value="Mercury">Mercury</option>
			<option value="Venus">Venus</option>
			<option value="Mars">Mars</option>
			<option value="Jupiter">Jupiter</option>
			<option value="Saturn">Saturn</option>
			<option value="Uranus">Uranus</option>
			<option value="Neptune">Neptune</option>
			<option value="pluto">Pluto</option>
		</select>
		<button onclick = "search()">Search</button>
	</div>
    <div id="map" class=widCol></div>
	    <script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js">
    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBfAMBIzbph25jjvV_LP1fVWtO8cqRDrp8&callback=initMap">
    </script>
	
	<script>
		function initMap(){
			var c = {lat: 0, lng: 0}
			var map = new google.maps.Map(document.getElementById("map"), {zoom: 4, center: c})
			var markers = locations.map(function(location, i){
				return new google.maps.Marker({position: location, label: "A"})
				})
			var markerCluster = new MarkerClusterer(map, markers,
            {imagePath: "https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m"});
		} 
		var locations = []
		
		function search(){
			let config = {}
			let body = document.getElementById("body").value
			let date = document.getElementById("date").value
			year = date.substring(0,4)
			month = date.substring(5,7)
			day = date.substring(8,10)
			
			config.method = "POST"
			config.body = JSON.stringify({bod: body, d: day, mon: month, yr: year})
			config.headers = {"Content-Type":"application/json", "Accept":"application/json"}
			console.log(year, month, day)
			fetch("http://localhost:5001/search?body="+body+"/day="+day+"/month="+month+"/year="+year)
				.then(function(response){
					console.log(response)
					return response.json()
					})
				.catch(error => console.error("Error :", error))
		}
	</script>
  </body>
</html>